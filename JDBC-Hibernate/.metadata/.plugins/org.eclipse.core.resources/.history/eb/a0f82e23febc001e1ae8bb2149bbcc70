package com.qsp.brs.controller;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.SQLException;

import com.qsp.brs.model.Bus;

public class BusController {
	static Bus bus=new Bus();
	public int addBus(int bus_no,String bus_name,String bus_start_destination,String bus_end_destination,double bus_fare)
	{
		int rowAffected=0;
		Connection connection=null;
		try {
			Class.forName("org.postgresql.Driver");
			connection= DriverManager.getConnection("jdbc:postgresql://localhost:5432/bus_registeration_system", "postgresql", "root");
			PreparedStatement prepareStatement = connection.prepareStatement("insert into bus values(?,?,?,?,?);");
			prepareStatement.setInt(1, bus_no);
			prepareStatement.setString(2, bus_name);
			prepareStatement.setString(3, bus_start_destination);
			prepareStatement.setString(4, bus_end_destination);
			prepareStatement.setDouble(5, bus_fare);
			
			rowAffected = prepareStatement.executeUpdate();
			
		} catch (ClassNotFoundException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
		
		return rowAffected;
	}
}
